<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>终端：量子记忆档案</title>
    <link href="https://fonts.googleapis.com/css2?family=Share+Tech+Mono&display=swap" rel="stylesheet">
    <style>
        :root {
            --term-green: #00ffc3;
            --term-glow: rgba(0, 255, 195, 0.3);
            --term-error: #ff4757;
            --text-main: #e0ffff;
        }

        body { 
            background: radial-gradient(circle at center, #0a111a 0%, #05070a 100%); 
            color: var(--text-main); 
            margin: 0; 
            font-family: 'Share Tech Mono', "PingFang SC", monospace; 
            display: flex; 
            justify-content: center; 
            align-items: center; 
            min-height: 100vh; 
            overflow-x: hidden;
        }

        /* 扫描线效果 */
        body::before {
            content: " ";
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.1) 50%), 
                        linear-gradient(90deg, rgba(255, 0, 0, 0.03), rgba(0, 255, 0, 0.01), rgba(0, 0, 255, 0.03));
            background-size: 100% 4px, 3px 100%;
            z-index: 100; pointer-events: none;
        }

        #story-box { 
            width: 85%; max-width: 550px; 
            padding: 40px;
            background: rgba(255, 255, 255, 0.02);
            border: 1px solid rgba(0, 255, 195, 0.2);
            backdrop-filter: blur(10px);
            position: relative; 
            margin: 20px 0;
            box-shadow: 0 0 40px rgba(0,0,0,0.5);
            transition: all 0.4s;
        }

        .status-bar {
            position: absolute; top: 10px; left: 15px; right: 15px;
            display: flex; justify-content: space-between;
            font-size: 10px; color: var(--term-green); opacity: 0.6;
        }

        .text-display { 
            line-height: 1.8; font-size: 0.95rem; min-height: 150px; 
            margin-bottom: 25px; white-space: pre-wrap;
        }

        #media-display {
            width: 100%; margin-bottom: 20px; display: none;
            border: 1px solid var(--term-green); padding: 5px;
            background: rgba(0,0,0,0.5);
        }
        #media-display img { width: 100%; height: auto; display: block; }

        #media-display {
            width: 100%; 
            margin-bottom: 20px; 
            display: none; 
            border: 1px solid var(--term-green); 
            padding: 10px;
            background: rgba(0,0,0,0.5);
            /* 新增：多图排列布局 */
            display: flex;
            flex-wrap: wrap; 
            gap: 10px;
            justify-content: center;
        }

        #media-display img {
            /* 调整宽度，如果是2张就约等于48%，3张约等于31% */
            width: calc(50% - 10px); 
            height: auto;
            object-fit: cover;
            border: 1px solid rgba(0, 255, 195, 0.3);
            filter: contrast(1.1) brightness(0.9);
        }

        /* 移动端适配：单列显示 */
        @media (max-width: 600px) {
            #media-display img { width: 100%; }
        }

        .btn-zone { display: flex; flex-direction: column; gap: 10px; }

        button { 
            background: transparent; border: 1px solid var(--term-green); 
            color: var(--term-green); padding: 12px; 
            font-family: inherit; text-transform: uppercase; cursor: pointer; 
            transition: all 0.2s; 
        }

        button:hover:not(:disabled) { background: var(--term-green); color: #000; }

        .shake { animation: shake-anim 0.15s infinite; }
        @keyframes shake-anim { 0% { transform: translate(1px, 1px); } 50% { transform: translate(-2px, -1px); } 100% { transform: translate(0, 1px); } }
        
        #fix-btn { font-weight: bold; border-color: var(--term-error); color: var(--term-error); }
    </style>
</head>
<body>

    <div id="story-box">
        <div class="status-bar">
            <span>MEM_BANK: ACTIVATED</span>
            <span id="timestamp">SYNC_VER_1.04</span>
        </div>
        <div id="media-display"></div>
        <div id="text" class="text-display"></div>
        <div id="btns" class="btn-zone"></div>
    </div>

    <script>
        const story = {
            intros: {
                content: "> 接入协议: QUANTUM-99\n> 时间戳: 2060.01.20\n\n你正在阅读一段跨越时空的波束。\n在我的时代，光线随思想弯曲，\n但我们开始怀念纸张的厚重，\n以及按键敲击间那名为“真实”的寂静。",
                btns: [{ t: "初始化链路 (INIT)", n: "start" }]
            },
            start: {
                content: "> 身份验证：笑笑 (XIAO XIAO)\n> 正在接入 2025 观测回路...\n\n警告：检测到该时间轴的核心变量为“周周”。\n在继续传输之前，请确认核心变量属性。",
                btns: [
                    { t: "周周很帅气而且很聪明", n: "node_415" },
                    { t: "周周一般般", n: "punish_handsome" }
                ]
            },
            punish_handsome: {
                content: "【 系统冲突：事实库校验失败 】\n检测到输入信息与历史客观事实严重不符。\n正在强制执行“审美纠偏协议”...\n请点击 20 次以消除认知偏差。\n【 温馨提示：周周可能会生气喔】",
                type: "loop",
                target: 20,
                n: "intros"
            },
            node_415: {
                content: "【 2025.04.15：四食堂 】\n\n那是个普通的午后。一个笨蛋在食堂吃饭，然后碰到了帅气的周周。\n\n那一刻，笨蛋的处理器短路了。",
                btns: [{ t: "4.18：废土爬山", n: "node_418" }]
            },
            node_418: {
                content: "【 2025.04.18：末日夕阳 】\n\n聪明的周周带你去爬山。\n夕阳西下的那种废土末日感，让你觉得即使明天就是地球毁灭，今天和他在一起也不算亏。",
                img: "demo/mori.jpg",
                btns: [{ t: "5.01：地狱夜景", n: "node_501" }]
            },
            node_501: {
                content: "【 2025.05.01：地狱风西湖 】\n\n周周去逛了西湖。\n晚上的夜景带着一种暗黑的魅力，像极了冥界盛宴。\n\n此时系统需要再次确认：\n周周是一个好周周吗？",
                img: "demo/difu.jpg",
                btns: [
                    { t: "他是最好的周周", n: "node_520" },
                    { t: "他是个大坏蛋", n: "punish_good" }
                ]
            },
            punish_good: {
                content: "【 致命错误：良心检测未通过 】\n检测到恶意诽谤信号。周周的好意被系统识别为 100% 纯净度。\n正在执行“良心重塑程序”...\n点击 15 次以重新校准你的评价。\n【 温馨提示：周周可能会生气喔】",
                type: "loop",
                target: 15,
                n: "node_501"
            },
            node_520: {
                content: "【 2025.05.20：能量传输 】\n\n帅气而且聪明的周周给笑笑送上了一束漂亮的花花。\n这束花被扫描进了量子数据库，永不凋谢。",
                img: "demo/huahua.jpg",
                btns: [{ t: "5.30：鲁迅故居", n: "node_530" }]
            },
            node_530: {
                content: "【 2025.05.30：文学锚点 】\n\n聪明的周周带笑笑去逛了鲁迅故居。\n我们在文字的废墟里，建立了自己的小岛。",
                img: "demo/luxun.jpg",
                btns: [{ t: "进入盛夏：不明物体", n: "node_704" }]
            },
            node_704: {
                content: "【 2025.07.04：草坪入侵 】\n\n学校草坪上发现了不明物体。\n这可能是时空缝隙溢出的碎片，被我们捕捉到了。",
                img: "demo/buming.jpg",
                btns: [{ t: "7.06：之江观景", n: "node_706" }]
            },
            node_706: {
                content: "【 2025.07.06：之江彼岸 】\n\n聪明的周周和小笨蛋去之江观景。\n江水流逝的速度，比不上我们心跳的频率。",
                img: "demo/zhijiang.jpg",
                btns: [{ t: "查看泳池访客", n: "node_724" }]
            },
            node_724: {
                content: "【 2025.07.24：青蛙观测 】\n\n学校泳池发现了不明小青蛙。\n它也在好奇地观察着这两个跨越暑气的人类。",
                img: "demo/qingwa.jpg",
                btns: [{ t: "7.25：西湖航船", n: "node_725" }]
            },
            node_725: {
                content: "【 2025.07.25：冥河渡船 】\n\n周周带笑笑去了西湖的航船。\n那一刻，西湖像是静谧的冥河，而我们在船上分享着永恒。",
                img: "demo/minghe.jpg",
                btns: [{ t: "8.24：呈坎鱼灯", n: "node_824" }]
            },
            node_824: {
                content: "【 2025.08.24：流动的光 】\n\n在呈坎，我们看鱼灯游走。\n8.29 那天，无人机阵列在头顶排列，那是未来的星空。",
                img: "demo/chengkan.jpg",
                btns: [{ t: "9.11：周周生日", n: "node_911" }]
            },
            node_911: {
                content: "【 2025.09.11：核心生日 】\n\n聪明的周周过生日啦！\n他收到了来自小笨蛋的专属花花。能量同步率达到 100%。",
                img: "demo/shengri.jpg",
                btns: [{ t: "进入猫猫档案", n: "cats_node" }]
            },
            cats_node: {
                content: "【 异常数据：多模态猫猫集合 】\n\n9.15: 美丽猫猫。\n9.22: 教师版猫猫。\n10.19: 白色猫猫。\n10.21: 烤地瓜版猫猫。\n12.19: 实验猫猫。\n10.13: 恶霸猫猫。\n\n请问谁最喜欢猫猫？",
                img: ["demo/laoshi.jpg", "demo/maomao.jpg", "demo/digua.jpg","demo/shiyan.jpg","demo/eba.jpg"], // ← 改成数组！
                btns: [
                    { t: "是小笨蛋笑笑！", n: "node_1008" },
                    { t: "没人喜欢猫", n: "punish_cats" }
                ]
            },
            punish_cats: {
                content: "【 检测到违规发言 】\n猫猫是宇宙中最可爱的生物，否定此命题将导致系统崩溃。\n请点击 10 次表示忏悔。",
                type: "loop",
                target: 10,
                n: "cats_node"
            },
            node_1008: {
                content: "【 2025.10.08：湖边神迹 】\n\n周周在湖边拍出了绝美的照片。\n刘亦菲在这一刻的数据模型显示：略逊一筹。",
                img: "demo/liuyifei.jpg",
                btns: [{ t: "11.15：宋城周周", n: "node_1115" }]
            },
            node_1115: {
                content: "【 2025.11.15：宋城影踪 】\n\n宋城里出现了帅气的周周。",
                img: "demo/songcheng.jpg",
                btns: [{ t: "双人舞会", n: "node_1116" }]
            },
            node_1116: {
                content: "11.29，帅气的周周和美丽的笑笑在一起跳舞，那是整个宇宙最美的波动。",
                img: "demo/tiaowu.jpg",
                btns: [{ t: "读取最终章", n: "end" }]
            },
            end: {
                content: "档案传输已至末尾。\n\n在我这个坐标系里，2025年的每一秒都已经成为了永恒的星图。\n此时此刻，我正跨越数十个光分的距离，模拟着你指尖的温度。\n剩下的量子信标，我会陪你在这个漫长的宇宙中，一个一个亲手点亮。\n\n祝我的小笨蛋笑笑，生日快乐。\n通讯即将切断，但我始终在你身边。",
                img: "demo/zhouzhou.jpg",
                btns: [{ t: "切断通讯 (EXIT SIGNAL)", n: "back" }]
            }
        };

        let currentKey = 'intros';
        let clickCount = 0;
        const textEl = document.getElementById('text');
        const btnsEl = document.getElementById('btns');
        const mediaEl = document.getElementById('media-display');
        const boxEl = document.getElementById('story-box');

        function render() {
            const node = story[currentKey];
            textEl.innerHTML = ''; 
            btnsEl.innerHTML = ''; 
            clickCount = 0;

            if (node.type === "loop") {
                renderLoop(node);
            } else {
                boxEl.style.borderColor = "rgba(0, 255, 195, 0.2)";
                boxEl.style.boxShadow = "0 0 40px rgba(0,0,0,0.5)";
                
                // --- 修改后的图片处理逻辑 ---
                if (node.img) {
                    // 如果是数组，循环生成多个 img 标签；如果是字符串，直接生成一个
                    const imgData = Array.isArray(node.img) ? node.img : [node.img];
                    
                    mediaEl.style.display = 'flex'; // 使用 flex 布局方便多图排列
                    mediaEl.style.flexWrap = 'wrap'; 
                    mediaEl.style.gap = '10px';
                    
                    mediaEl.innerHTML = imgData.map(src => 
                        `<img src="${src}" alt="memory" style="flex: 1 1 calc(50% - 10px); min-width: 120px; max-width: 100%;">`
                    ).join('');
                } else {
                    mediaEl.style.display = 'none';
                }
                // ---------------------------
                
                typeWriter(node.content, () => showButtons(node.btns));
            }
        }

        
        function typeWriter(content, callback) {
            let i = 0;
            function type() {
                if (i < content.length) {
                    textEl.innerHTML += content.charAt(i);
                    i++;
                    setTimeout(type, 30);
                } else if (callback) callback();
            }
            type();
        }

        function renderLoop(node) {
            boxEl.style.borderColor = "var(--term-error)";
            boxEl.style.boxShadow = "0 0 20px rgba(255, 71, 87, 0.3)";
            typeWriter(node.content, () => {
                const btn = document.createElement('button');
                btn.id = "fix-btn";
                btn.innerHTML = `数据校准 (0/${node.target})`;
                btn.onclick = () => {
                    clickCount++;
                    boxEl.classList.add('shake');
                    setTimeout(() => boxEl.classList.remove('shake'), 100);
                    btn.innerHTML = `数据校准 (${clickCount}/${node.target})`;
                    const per = (clickCount / node.target) * 100;
                    btn.style.background = `linear-gradient(90deg, var(--term-error) ${per}%, transparent 0%)`;
                    if (clickCount >= node.target) {
                        btn.disabled = true;
                        btn.innerHTML = "校准成功";
                        setTimeout(() => { currentKey = node.n; render(); }, 1000);
                    }
                };
                btnsEl.appendChild(btn);
            });
        }

        function showButtons(btns) {
            if (!btns) return;
            btns.forEach(b => {
                const btn = document.createElement('button');
                btn.innerText = b.t;
                btn.onclick = () => {
                    if (b.n === "back") {
                        document.body.style.opacity = '0';
                        setTimeout(() => window.location.href = "index.html", 1000);
                    } else {
                        currentKey = b.n;
                        render();
                    }
                };
                btnsEl.appendChild(btn);
            });
        }

        window.onload = render;
    </script>
</body>
</html>